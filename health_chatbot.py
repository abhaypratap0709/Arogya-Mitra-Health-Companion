import streamlit as st
import re
from datetime import datetime
from translator import TranslationManager

class HealthChatbot:
    def __init__(self):
        self.translator = TranslationManager()
        
        # Health knowledge base with keywords and responses
        self.health_knowledge = {
            # Fever related
            'fever': {
                'keywords': ['fever', 'temperature', 'hot', 'burning', 'pyrexia', 'high temp'],
                'response': {
                    'en': """ЁЯМбя╕П **Fever Information:**
                    
**Symptoms:** High body temperature (>100.4┬░F/38┬░C), chills, sweating, headache, muscle aches

**Immediate Care:**
тАв Rest and stay hydrated
тАв Take paracetamol (500-1000mg every 6 hours)
тАв Use cool compresses
тАв Monitor temperature regularly

**When to see a doctor:**
тАв Fever >103┬░F (39.4┬░C)
тАв Fever lasting >3 days
тАв Severe headache or neck stiffness
тАв Difficulty breathing
тАв Rash with fever

**тЪая╕П Emergency:** If fever is very high (>104┬░F) or accompanied by severe symptoms, seek immediate medical attention.""",
                    'hi': """ЁЯМбя╕П **рдмреБрдЦрд╛рд░ рдХреА рдЬрд╛рдирдХрд╛рд░реА:**
                    
**рд▓рдХреНрд╖рдг:** рдЙрдЪреНрдЪ рд╢рд░реАрд░ рдХрд╛ рддрд╛рдкрдорд╛рди (>100.4┬░F/38┬░C), рдардВрдб рд▓рдЧрдирд╛, рдкрд╕реАрдирд╛, рд╕рд┐рд░рджрд░реНрдж, рдорд╛рдВрд╕рдкреЗрд╢рд┐рдпреЛрдВ рдореЗрдВ рджрд░реНрдж

**рддреБрд░рдВрдд рджреЗрдЦрднрд╛рд▓:**
тАв рдЖрд░рд╛рдо рдХрд░реЗрдВ рдФрд░ рд╣рд╛рдЗрдбреНрд░реЗрдЯреЗрдб рд░рд╣реЗрдВ
тАв рдкреИрд░рд╛рд╕рд┐рдЯрд╛рдореЛрд▓ рд▓реЗрдВ (500-1000mg рд╣рд░ 6 рдШрдВрдЯреЗ)
тАв рдардВрдбреЗ рдХрдкрдбрд╝реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
тАв рддрд╛рдкрдорд╛рди рдХреА рдирд┐рдпрдорд┐рдд рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдВ

**рдбреЙрдХреНрдЯрд░ рд╕реЗ рдХрдм рдорд┐рд▓реЗрдВ:**
тАв рдмреБрдЦрд╛рд░ >103┬░F (39.4┬░C)
тАв рдмреБрдЦрд╛рд░ 3 рджрд┐рди рд╕реЗ рдЕрдзрд┐рдХ
тАв рдЧрдВрднреАрд░ рд╕рд┐рд░рджрд░реНрдж рдпрд╛ рдЧрд░реНрджрди рдореЗрдВ рдЕрдХрдбрд╝рди
тАв рд╕рд╛рдВрд╕ рд▓реЗрдиреЗ рдореЗрдВ рдХрдард┐рдирд╛рдИ
тАв рдмреБрдЦрд╛рд░ рдХреЗ рд╕рд╛рде рдЪрдХрддреНрддреЗ

**тЪая╕П рдЖрдкрд╛рддрдХрд╛рд▓:** рдпрджрд┐ рдмреБрдЦрд╛рд░ рдмрд╣реБрдд рдЕрдзрд┐рдХ (>104┬░F) рд╣реИ рдпрд╛ рдЧрдВрднреАрд░ рд▓рдХреНрд╖рдгреЛрдВ рдХреЗ рд╕рд╛рде рд╣реИ, рддреЛ рддреБрд░рдВрдд рдЪрд┐рдХрд┐рддреНрд╕рд╛ рд╕рд╣рд╛рдпрддрд╛ рд▓реЗрдВред"""
                }
            },
            
            # Cold related
            'cold': {
                'keywords': ['cold', 'common cold', 'runny nose', 'nasal congestion', 'sneezing', 'stuffy nose'],
                'response': {
                    'en': """ЁЯдз **Common Cold Information:**
                    
**Symptoms:** Runny nose, sneezing, sore throat, mild cough, congestion

**Home Remedies:**
тАв Drink warm fluids (tea, soup)
тАв Use saline nasal drops
тАв Gargle with warm salt water
тАв Get plenty of rest
тАв Use humidifier

**Medications:**
тАв Paracetamol for fever/pain
тАв Antihistamines for runny nose
тАв Decongestants for stuffy nose
тАв Throat lozenges for sore throat

**Duration:** Usually resolves in 7-10 days

**When to see a doctor:**
тАв Symptoms worsen after 5 days
тАв High fever (>101┬░F)
тАв Severe headache or sinus pain
тАв Difficulty breathing""",
                    'hi': """ЁЯдз **рд╕рд╛рдорд╛рдиреНрдп рд╕рд░реНрджреА рдХреА рдЬрд╛рдирдХрд╛рд░реА:**
                    
**рд▓рдХреНрд╖рдг:** рдмрд╣рддреА рдирд╛рдХ, рдЫреАрдВрдХрдирд╛, рдЧрд▓реЗ рдореЗрдВ рдЦрд░рд╛рд╢, рд╣рд▓реНрдХреА рдЦрд╛рдВрд╕реА, рднреАрдбрд╝

**рдШрд░реЗрд▓реВ рдЙрдкрдЪрд╛рд░:**
тАв рдЧрд░реНрдо рддрд░рд▓ рдкрджрд╛рд░реНрде рдкрд┐рдПрдВ (рдЪрд╛рдп, рд╕реВрдк)
тАв рдирдордХреАрди рдирд╛рдХ рдХреА рдмреВрдВрджреЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
тАв рдЧрд░реНрдо рдирдордХ рдХреЗ рдкрд╛рдиреА рд╕реЗ рдЧрд░рд╛рд░реЗ рдХрд░реЗрдВ
тАв рднрд░рдкреВрд░ рдЖрд░рд╛рдо рдХрд░реЗрдВ
тАв рд╣реНрдпреВрдорд┐рдбрд┐рдлрд╛рдпрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

**рджрд╡рд╛рдПрдВ:**
тАв рдмреБрдЦрд╛рд░/рджрд░реНрдж рдХреЗ рд▓рд┐рдП рдкреИрд░рд╛рд╕рд┐рдЯрд╛рдореЛрд▓
тАв рдмрд╣рддреА рдирд╛рдХ рдХреЗ рд▓рд┐рдП рдПрдВрдЯреАрд╣рд┐рд╕реНрдЯрд╛рдорд╛рдЗрди
тАв рднреАрдбрд╝ рдХреЗ рд▓рд┐рдП рдбрд┐рдХреЙрдиреНрдЧреЗрд╕реНрдЯреЗрдВрдЯ
тАв рдЧрд▓реЗ рдореЗрдВ рдЦрд░рд╛рд╢ рдХреЗ рд▓рд┐рдП рдЧрд▓реЗ рдХреА рдЧреЛрд▓рд┐рдпрд╛рдВ

**рдЕрд╡рдзрд┐:** рдЖрдорддреМрд░ рдкрд░ 7-10 рджрд┐рдиреЛрдВ рдореЗрдВ рдареАрдХ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ

**рдбреЙрдХреНрдЯрд░ рд╕реЗ рдХрдм рдорд┐рд▓реЗрдВ:**
тАв 5 рджрд┐рди рдмрд╛рдж рд▓рдХреНрд╖рдг рдмрд┐рдЧрдбрд╝рддреЗ рд╣реИрдВ
тАв рдЙрдЪреНрдЪ рдмреБрдЦрд╛рд░ (>101┬░F)
тАв рдЧрдВрднреАрд░ рд╕рд┐рд░рджрд░реНрдж рдпрд╛ рд╕рд╛рдЗрдирд╕ рджрд░реНрдж
тАв рд╕рд╛рдВрд╕ рд▓реЗрдиреЗ рдореЗрдВ рдХрдард┐рдирд╛рдИ"""
                }
            },
            
            # Cough related
            'cough': {
                'keywords': ['cough', 'coughing', 'dry cough', 'wet cough', 'chest cough', 'throat cough'],
                'response': {
                    'en': """ЁЯлБ **Cough Information:**
                    
**Types:**
тАв **Dry cough:** No mucus, often irritating
тАв **Wet cough:** Produces mucus/phlegm

**Home Remedies:**
тАв Stay hydrated (warm water, tea)
тАв Honey (1-2 tsp, not for children <1 year)
тАв Steam inhalation
тАв Avoid irritants (smoke, dust)
тАв Elevate head while sleeping

**Medications:**
тАв Cough suppressants for dry cough
тАв Expectorants for wet cough
тАв Throat lozenges
тАв Warm salt water gargles

**When to see a doctor:**
тАв Cough lasting >3 weeks
тАв Blood in mucus
тАв Difficulty breathing
тАв Chest pain
тАв High fever with cough
тАв Wheezing sounds""",
                    'hi': """ЁЯлБ **рдЦрд╛рдВрд╕реА рдХреА рдЬрд╛рдирдХрд╛рд░реА:**
                    
**рдкреНрд░рдХрд╛рд░:**
тАв **рд╕реВрдЦреА рдЦрд╛рдВрд╕реА:** рдмрд▓рдЧрдо рдирд╣реАрдВ, рдЕрдХреНрд╕рд░ рдкрд░реЗрд╢рд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓реА
тАв **рдЧреАрд▓реА рдЦрд╛рдВрд╕реА:** рдмрд▓рдЧрдо/рдХрдл рдкреИрджрд╛ рдХрд░рддреА рд╣реИ

**рдШрд░реЗрд▓реВ рдЙрдкрдЪрд╛рд░:**
тАв рд╣рд╛рдЗрдбреНрд░реЗрдЯреЗрдб рд░рд╣реЗрдВ (рдЧрд░реНрдо рдкрд╛рдиреА, рдЪрд╛рдп)
тАв рд╢рд╣рдж (1-2 рдЪрдореНрдордЪ, 1 рд╕рд╛рд▓ рд╕реЗ рдХрдо рдЙрдореНрд░ рдХреЗ рдмрдЪреНрдЪреЛрдВ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ)
тАв рднрд╛рдк рд▓реЗрдирд╛
тАв рдкрд░реЗрд╢рд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓реА рдЪреАрдЬреЛрдВ рд╕реЗ рдмрдЪреЗрдВ (рдзреБрдЖрдВ, рдзреВрд▓)
тАв рд╕реЛрддреЗ рд╕рдордп рд╕рд┐рд░ рдКрдВрдЪрд╛ рд░рдЦреЗрдВ

**рджрд╡рд╛рдПрдВ:**
тАв рд╕реВрдЦреА рдЦрд╛рдВрд╕реА рдХреЗ рд▓рд┐рдП рдЦрд╛рдВрд╕реА рджрдмрд╛рдиреЗ рд╡рд╛рд▓реА рджрд╡рд╛рдПрдВ
тАв рдЧреАрд▓реА рдЦрд╛рдВрд╕реА рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕рдкреЗрдХреНрдЯреЛрд░реЗрдВрдЯ
тАв рдЧрд▓реЗ рдХреА рдЧреЛрд▓рд┐рдпрд╛рдВ
тАв рдЧрд░реНрдо рдирдордХ рдХреЗ рдкрд╛рдиреА рд╕реЗ рдЧрд░рд╛рд░реЗ

**рдбреЙрдХреНрдЯрд░ рд╕реЗ рдХрдм рдорд┐рд▓реЗрдВ:**
тАв 3 рд╕рдкреНрддрд╛рд╣ рд╕реЗ рдЕрдзрд┐рдХ рдЦрд╛рдВрд╕реА
тАв рдмрд▓рдЧрдо рдореЗрдВ рдЦреВрди
тАв рд╕рд╛рдВрд╕ рд▓реЗрдиреЗ рдореЗрдВ рдХрдард┐рдирд╛рдИ
тАв рдЫрд╛рддреА рдореЗрдВ рджрд░реНрдж
тАв рдЦрд╛рдВрд╕реА рдХреЗ рд╕рд╛рде рдЙрдЪреНрдЪ рдмреБрдЦрд╛рд░
тАв рдШрд░рдШрд░рд╛рд╣рдЯ рдХреА рдЖрд╡рд╛рдЬ"""
                }
            },
            
            # Malaria related
            'malaria': {
                'keywords': ['malaria', 'malarial fever', 'plasmodium', 'mosquito bite', 'chills and fever'],
                'response': {
                    'en': """ЁЯжЯ **Malaria Information:**
                    
**Symptoms:**
тАв High fever with chills
тАв Sweating
тАв Headache
тАв Nausea and vomiting
тАв Muscle pain
тАв Fatigue

**Transmission:** Mosquito bite (Anopheles mosquito)

**Prevention:**
тАв Use mosquito nets
тАв Apply insect repellent
тАв Wear long sleeves/pants
тАв Eliminate standing water
тАв Use window screens

**Treatment:** Requires prescription medication (antimalarials)

**тЪая╕П Important:** Malaria can be life-threatening. If you suspect malaria, seek immediate medical attention.

**When to see a doctor immediately:**
тАв Fever with chills in malaria-endemic areas
тАв Any malaria symptoms
тАв Recent travel to malaria-prone regions""",
                    'hi': """ЁЯжЯ **рдорд▓реЗрд░рд┐рдпрд╛ рдХреА рдЬрд╛рдирдХрд╛рд░реА:**
                    
**рд▓рдХреНрд╖рдг:**
тАв рдардВрдб рдХреЗ рд╕рд╛рде рдЙрдЪреНрдЪ рдмреБрдЦрд╛рд░
тАв рдкрд╕реАрдирд╛
тАв рд╕рд┐рд░рджрд░реНрдж
тАв рдорддрд▓реА рдФрд░ рдЙрд▓реНрдЯреА
тАв рдорд╛рдВрд╕рдкреЗрд╢рд┐рдпреЛрдВ рдореЗрдВ рджрд░реНрдж
тАв рдердХрд╛рди

**рд╕рдВрдЪрд░рдг:** рдордЪреНрдЫрд░ рдХрд╛ рдХрд╛рдЯрдирд╛ (рдПрдиреЛрдлрд┐рд▓реАрдЬ рдордЪреНрдЫрд░)

**рд░реЛрдХрдерд╛рдо:**
тАв рдордЪреНрдЫрд░рджрд╛рдиреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
тАв рдХреАрдЯрдирд╛рд╢рдХ рд▓рдЧрд╛рдПрдВ
тАв рд▓рдВрдмреА рдЖрд╕реНрддреАрди/рдкреИрдВрдЯ рдкрд╣рдиреЗрдВ
тАв рдЦрдбрд╝реЗ рдкрд╛рдиреА рдХреЛ рдЦрддреНрдо рдХрд░реЗрдВ
тАв рдЦрд┐рдбрд╝рдХреА рдХреЗ рдЬрд╛рд▓реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

**рдЙрдкрдЪрд╛рд░:** рдиреБрд╕реНрдЦреЗ рдХреА рджрд╡рд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ (рдПрдВрдЯреАрдорд▓реЗрд░рд┐рдпрд▓)

**тЪая╕П рдорд╣рддреНрд╡рдкреВрд░реНрдг:** рдорд▓реЗрд░рд┐рдпрд╛ рдЬрд╛рдирд▓реЗрд╡рд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХреЛ рдорд▓реЗрд░рд┐рдпрд╛ рдХрд╛ рд╕рдВрджреЗрд╣ рд╣реИ, рддреЛ рддреБрд░рдВрдд рдЪрд┐рдХрд┐рддреНрд╕рд╛ рд╕рд╣рд╛рдпрддрд╛ рд▓реЗрдВред

**рддреБрд░рдВрдд рдбреЙрдХреНрдЯрд░ рд╕реЗ рдХрдм рдорд┐рд▓реЗрдВ:**
тАв рдорд▓реЗрд░рд┐рдпрд╛-рдкреНрд░рднрд╛рд╡рд┐рдд рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рдардВрдб рдХреЗ рд╕рд╛рде рдмреБрдЦрд╛рд░
тАв рдХреЛрдИ рднреА рдорд▓реЗрд░рд┐рдпрд╛ рд▓рдХреНрд╖рдг
тАв рдорд▓реЗрд░рд┐рдпрд╛-рдкреНрд░рд╡рдг рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреА рд╣рд╛рд▓ рдХреА рдпрд╛рддреНрд░рд╛"""
                }
            },
            
            # Diabetes related
            'diabetes': {
                'keywords': ['diabetes', 'diabetic', 'blood sugar', 'glucose', 'insulin', 'high sugar'],
                'response': {
                    'en': """ЁЯНп **Diabetes Information:**
                    
**Types:**
тАв **Type 1:** Body doesn't produce insulin
тАв **Type 2:** Body doesn't use insulin properly
тАв **Gestational:** During pregnancy

**Common Symptoms:**
тАв Frequent urination
тАв Excessive thirst
тАв Unexplained weight loss
тАв Fatigue
тАв Blurred vision
тАв Slow healing wounds

**Management:**
тАв Regular blood sugar monitoring
тАв Healthy diet (low sugar, high fiber)
тАв Regular exercise
тАв Medication as prescribed
тАв Regular doctor visits

**тЪая╕П Emergency:** Very high or very low blood sugar can be dangerous.

**When to see a doctor:**
тАв Any diabetes symptoms
тАв Family history of diabetes
тАв Regular checkups if diagnosed""",
                    'hi': """ЁЯНп **рдордзреБрдореЗрд╣ рдХреА рдЬрд╛рдирдХрд╛рд░реА:**
                    
**рдкреНрд░рдХрд╛рд░:**
тАв **рдЯрд╛рдЗрдк 1:** рд╢рд░реАрд░ рдЗрдВрд╕реБрд▓рд┐рди рдирд╣реАрдВ рдмрдирд╛рддрд╛
тАв **рдЯрд╛рдЗрдк 2:** рд╢рд░реАрд░ рдЗрдВрд╕реБрд▓рд┐рди рдХрд╛ рд╕рд╣реА рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛
тАв **рдЧрд░реНрднрд╛рд╡рд╕реНрдерд╛:** рдЧрд░реНрднрд╛рд╡рд╕реНрдерд╛ рдХреЗ рджреМрд░рд╛рди

**рд╕рд╛рдорд╛рдиреНрдп рд▓рдХреНрд╖рдг:**
тАв рдмрд╛рд░-рдмрд╛рд░ рдкреЗрд╢рд╛рдм
тАв рдЕрддреНрдпрдзрд┐рдХ рдкреНрдпрд╛рд╕
тАв рдмрд┐рдирд╛ рдХрд╛рд░рдг рд╡рдЬрди рдХрдо рд╣реЛрдирд╛
тАв рдердХрд╛рди
тАв рдзреБрдВрдзрд▓реА рджреГрд╖реНрдЯрд┐
тАв рдзреАрдореА рдЪрд┐рдХрд┐рддреНрд╕рд╛

**рдкреНрд░рдмрдВрдзрди:**
тАв рдирд┐рдпрдорд┐рдд рд░рдХреНрдд рд╢рд░реНрдХрд░рд╛ рдирд┐рдЧрд░рд╛рдиреА
тАв рд╕реНрд╡рд╕реНрде рдЖрд╣рд╛рд░ (рдХрдо рдЪреАрдиреА, рдЙрдЪреНрдЪ рдлрд╛рдЗрдмрд░)
тАв рдирд┐рдпрдорд┐рдд рд╡реНрдпрд╛рдпрд╛рдо
тАв рдирд┐рд░реНрдзрд╛рд░рд┐рдд рджрд╡рд╛рдПрдВ
тАв рдирд┐рдпрдорд┐рдд рдбреЙрдХреНрдЯрд░ рдХреА рдЬрд╛рдВрдЪ

**тЪая╕П рдЖрдкрд╛рддрдХрд╛рд▓:** рдмрд╣реБрдд рдЕрдзрд┐рдХ рдпрд╛ рдмрд╣реБрдд рдХрдо рд░рдХреНрдд рд╢рд░реНрдХрд░рд╛ рдЦрддрд░рдирд╛рдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

**рдбреЙрдХреНрдЯрд░ рд╕реЗ рдХрдм рдорд┐рд▓реЗрдВ:**
тАв рдХреЛрдИ рднреА рдордзреБрдореЗрд╣ рд▓рдХреНрд╖рдг
тАв рдордзреБрдореЗрд╣ рдХрд╛ рдкрд╛рд░рд┐рд╡рд╛рд░рд┐рдХ рдЗрддрд┐рд╣рд╛рд╕
тАв рдирд┐рджрд╛рди рд╣реЛрдиреЗ рдкрд░ рдирд┐рдпрдорд┐рдд рдЬрд╛рдВрдЪ"""
                }
            },
            
            # Tuberculosis related
            'tb': {
                'keywords': ['tuberculosis', 'tb', 'tuberculosis', 'pulmonary tb', 'lung infection', 'mycobacterium'],
                'response': {
                    'en': """ЁЯлБ **Tuberculosis (TB) Information:**
                    
**Symptoms:**
тАв Persistent cough (>3 weeks)
тАв Coughing up blood
тАв Chest pain
тАв Fatigue
тАв Weight loss
тАв Night sweats
тАв Fever

**Transmission:** Airborne (coughing, sneezing)

**Treatment:** Long-term antibiotic course (6+ months)

**Prevention:**
тАв BCG vaccination (in some countries)
тАв Good ventilation
тАв Cover mouth when coughing
тАв Complete treatment if diagnosed

**тЪая╕П Important:** TB is curable with proper treatment. Untreated TB can be fatal.

**When to see a doctor immediately:**
тАв Persistent cough with blood
тАв Any TB symptoms
тАв Contact with TB patient
тАв Unexplained weight loss with cough""",
                    'hi': """ЁЯлБ **рдХреНрд╖рдп рд░реЛрдЧ (рдЯреАрдмреА) рдХреА рдЬрд╛рдирдХрд╛рд░реА:**
                    
**рд▓рдХреНрд╖рдг:**
тАв рд▓рдЧрд╛рддрд╛рд░ рдЦрд╛рдВрд╕реА (>3 рд╕рдкреНрддрд╛рд╣)
тАв рдЦреВрди рдХреА рдЦрд╛рдВрд╕реА
тАв рдЫрд╛рддреА рдореЗрдВ рджрд░реНрдж
тАв рдердХрд╛рди
тАв рд╡рдЬрди рдХрдо рд╣реЛрдирд╛
тАв рд░рд╛рдд рдХреЛ рдкрд╕реАрдирд╛
тАв рдмреБрдЦрд╛рд░

**рд╕рдВрдЪрд░рдг:** рд╣рд╡рд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (рдЦрд╛рдВрд╕рдирд╛, рдЫреАрдВрдХрдирд╛)

**рдЙрдкрдЪрд╛рд░:** рджреАрд░реНрдШрдХрд╛рд▓рд┐рдХ рдПрдВрдЯреАрдмрд╛рдпреЛрдЯрд┐рдХ рдХреЛрд░реНрд╕ (6+ рдорд╣реАрдиреЗ)

**рд░реЛрдХрдерд╛рдо:**
тАв рдмреАрд╕реАрдЬреА рдЯреАрдХрд╛рдХрд░рдг (рдХреБрдЫ рджреЗрд╢реЛрдВ рдореЗрдВ)
тАв рдЕрдЪреНрдЫрд╛ рд╡реЗрдВрдЯрд┐рд▓реЗрд╢рди
тАв рдЦрд╛рдВрд╕рддреЗ рд╕рдордп рдореБрдВрд╣ рдврдХреЗрдВ
тАв рдирд┐рджрд╛рди рд╣реЛрдиреЗ рдкрд░ рдкреВрд░рд╛ рдЙрдкрдЪрд╛рд░

**тЪая╕П рдорд╣рддреНрд╡рдкреВрд░реНрдг:** рдЯреАрдмреА рдЙрдЪрд┐рдд рдЙрдкрдЪрд╛рд░ рд╕реЗ рдареАрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЕрдиреБрдкрдЪрд╛рд░рд┐рдд рдЯреАрдмреА рдШрд╛рддрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

**рддреБрд░рдВрдд рдбреЙрдХреНрдЯрд░ рд╕реЗ рдХрдм рдорд┐рд▓реЗрдВ:**
тАв рдЦреВрди рдХреЗ рд╕рд╛рде рд▓рдЧрд╛рддрд╛рд░ рдЦрд╛рдВрд╕реА
тАв рдХреЛрдИ рднреА рдЯреАрдмреА рд▓рдХреНрд╖рдг
тАв рдЯреАрдмреА рд░реЛрдЧреА рдХреЗ рд╕рдВрдкрд░реНрдХ рдореЗрдВ
тАв рдЦрд╛рдВрд╕реА рдХреЗ рд╕рд╛рде рдмрд┐рдирд╛ рдХрд╛рд░рдг рд╡рдЬрди рдХрдо рд╣реЛрдирд╛"""
                }
            },
            
            # Medicine information
            'paracetamol': {
                'keywords': ['paracetamol', 'acetaminophen', 'tylenol', 'calpol', 'dolo'],
                'response': {
                    'en': """ЁЯТК **Paracetamol Information:**
                    
**Uses:** Pain relief, fever reduction

**Dosage:**
тАв Adults: 500-1000mg every 6 hours
тАв Children: 10-15mg/kg every 6 hours
тАв Maximum: 4000mg per day (adults)

**Side Effects:**
тАв Rare when taken correctly
тАв Liver damage if overdose
тАв Allergic reactions (rare)

**Precautions:**
тАв Don't exceed recommended dose
тАв Avoid alcohol
тАв Check other medications for paracetamol
тАв Consult doctor if pregnant/breastfeeding

**тЪая╕П Warning:** Overdose can cause liver failure. Never exceed 4000mg/day.""",
                    'hi': """ЁЯТК **рдкреИрд░рд╛рд╕рд┐рдЯрд╛рдореЛрд▓ рдХреА рдЬрд╛рдирдХрд╛рд░реА:**
                    
**рдЙрдкрдпреЛрдЧ:** рджрд░реНрдж рд╕реЗ рд░рд╛рд╣рдд, рдмреБрдЦрд╛рд░ рдХрдо рдХрд░рдирд╛

**рдЦреБрд░рд╛рдХ:**
тАв рд╡рдпрд╕реНрдХ: 500-1000mg рд╣рд░ 6 рдШрдВрдЯреЗ
тАв рдмрдЪреНрдЪреЗ: 10-15mg/kg рд╣рд░ 6 рдШрдВрдЯреЗ
тАв рдЕрдзрд┐рдХрддрдо: 4000mg рдкреНрд░рддрд┐ рджрд┐рди (рд╡рдпрд╕реНрдХ)

**рджреБрд╖реНрдкреНрд░рднрд╛рд╡:**
тАв рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рд▓реЗрдиреЗ рдкрд░ рджреБрд░реНрд▓рдн
тАв рдЕрдзрд┐рдХ рдорд╛рддреНрд░рд╛ рдореЗрдВ рд▓рд┐рд╡рд░ рдХреНрд╖рддрд┐
тАв рдПрд▓рд░реНрдЬрд┐рдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ (рджреБрд░реНрд▓рдн)

**рд╕рд╛рд╡рдзрд╛рдирд┐рдпрд╛рдВ:**
тАв рдЕрдиреБрд╢рдВрд╕рд┐рдд рдЦреБрд░рд╛рдХ рд╕реЗ рдЕрдзрд┐рдХ рди рд▓реЗрдВ
тАв рд╢рд░рд╛рдм рд╕реЗ рдмрдЪреЗрдВ
тАв рдЕрдиреНрдп рджрд╡рд╛рдУрдВ рдореЗрдВ рдкреИрд░рд╛рд╕рд┐рдЯрд╛рдореЛрд▓ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
тАв рдЧрд░реНрднрд╡рддреА/рд╕реНрддрдирдкрд╛рди рдХрд░рд╛рдиреЗ рд╡рд╛рд▓реА рдорд╣рд┐рд▓рд╛рдПрдВ рдбреЙрдХреНрдЯрд░ рд╕реЗ рд╕рд▓рд╛рд╣ рд▓реЗрдВ

**тЪая╕П рдЪреЗрддрд╛рд╡рдиреА:** рдЕрдзрд┐рдХ рдорд╛рддреНрд░рд╛ рд▓рд┐рд╡рд░ рдлреЗрд▓реНрдпреЛрд░ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддреА рд╣реИред рдХрднреА рднреА 4000mg/рджрд┐рди рд╕реЗ рдЕрдзрд┐рдХ рди рд▓реЗрдВред"""
                }
            },
            
            'ibuprofen': {
                'keywords': ['ibuprofen', 'brufen', 'advil', 'motrin', 'nurofen'],
                'response': {
                    'en': """ЁЯТК **Ibuprofen Information:**
                    
**Uses:** Pain relief, inflammation reduction, fever reduction

**Dosage:**
тАв Adults: 200-400mg every 6-8 hours
тАв Children: 5-10mg/kg every 6-8 hours
тАв Maximum: 2400mg per day (adults)

**Side Effects:**
тАв Stomach upset
тАв Heartburn
тАв Dizziness
тАв Headache
тАв Increased bleeding risk

**Precautions:**
тАв Take with food
тАв Avoid if stomach ulcers
тАв Don't use if allergic to aspirin
тАв Consult doctor if pregnant/breastfeeding
тАв Monitor blood pressure

**тЪая╕П Warning:** Can cause stomach bleeding. Take with food.""",
                    'hi': """ЁЯТК **рдЖрдЗрдмреБрдкреНрд░реЛрдлреЗрди рдХреА рдЬрд╛рдирдХрд╛рд░реА:**
                    
**рдЙрдкрдпреЛрдЧ:** рджрд░реНрдж рд╕реЗ рд░рд╛рд╣рдд, рд╕реВрдЬрди рдХрдо рдХрд░рдирд╛, рдмреБрдЦрд╛рд░ рдХрдо рдХрд░рдирд╛

**рдЦреБрд░рд╛рдХ:**
тАв рд╡рдпрд╕реНрдХ: 200-400mg рд╣рд░ 6-8 рдШрдВрдЯреЗ
тАв рдмрдЪреНрдЪреЗ: 5-10mg/kg рд╣рд░ 6-8 рдШрдВрдЯреЗ
тАв рдЕрдзрд┐рдХрддрдо: 2400mg рдкреНрд░рддрд┐ рджрд┐рди (рд╡рдпрд╕реНрдХ)

**рджреБрд╖реНрдкреНрд░рднрд╛рд╡:**
тАв рдкреЗрдЯ рдореЗрдВ рдкрд░реЗрд╢рд╛рдиреА
тАв рд╕реАрдиреЗ рдореЗрдВ рдЬрд▓рди
тАв рдЪрдХреНрдХрд░ рдЖрдирд╛
тАв рд╕рд┐рд░рджрд░реНрдж
тАв рд░рдХреНрддрд╕реНрд░рд╛рд╡ рдХрд╛ рдЦрддрд░рд╛ рдмрдврд╝рдирд╛

**рд╕рд╛рд╡рдзрд╛рдирд┐рдпрд╛рдВ:**
тАв рднреЛрдЬрди рдХреЗ рд╕рд╛рде рд▓реЗрдВ
тАв рдкреЗрдЯ рдХреЗ рдЕрд▓реНрд╕рд░ рд╣реЛ рддреЛ рди рд▓реЗрдВ
тАв рдПрд╕реНрдкрд┐рд░рд┐рди рд╕реЗ рдПрд▓рд░реНрдЬреА рд╣реЛ рддреЛ рди рд▓реЗрдВ
тАв рдЧрд░реНрднрд╡рддреА/рд╕реНрддрдирдкрд╛рди рдХрд░рд╛рдиреЗ рд╡рд╛рд▓реА рдорд╣рд┐рд▓рд╛рдПрдВ рдбреЙрдХреНрдЯрд░ рд╕реЗ рд╕рд▓рд╛рд╣ рд▓реЗрдВ
тАв рд░рдХреНрддрдЪрд╛рдк рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдВ

**тЪая╕П рдЪреЗрддрд╛рд╡рдиреА:** рдкреЗрдЯ рдореЗрдВ рд░рдХреНрддрд╕реНрд░рд╛рд╡ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред рднреЛрдЬрди рдХреЗ рд╕рд╛рде рд▓реЗрдВред"""
                }
            },
            
            'antibiotics': {
                'keywords': ['antibiotics', 'antibiotic', 'amoxicillin', 'azithromycin', 'ciprofloxacin', 'penicillin'],
                'response': {
                    'en': """ЁЯТК **Antibiotics Information:**
                    
**Important:** Antibiotics require prescription and should only be taken as directed by a doctor.

**Common Types:**
тАв Amoxicillin
тАв Azithromycin
тАв Ciprofloxacin
тАв Penicillin

**Key Points:**
тАв Complete the full course even if feeling better
тАв Don't share antibiotics
тАв Don't use leftover antibiotics
тАв Take at regular intervals
тАв Some require food, others on empty stomach

**Side Effects:**
тАв Nausea
тАв Diarrhea
тАв Allergic reactions
тАв Yeast infections (women)

**тЪая╕П Critical:** 
тАв Antibiotic resistance is a serious problem
тАв Only take when prescribed by a doctor
тАв Never self-medicate with antibiotics""",
                    'hi': """ЁЯТК **рдПрдВрдЯреАрдмрд╛рдпреЛрдЯрд┐рдХреНрд╕ рдХреА рдЬрд╛рдирдХрд╛рд░реА:**
                    
**рдорд╣рддреНрд╡рдкреВрд░реНрдг:** рдПрдВрдЯреАрдмрд╛рдпреЛрдЯрд┐рдХреНрд╕ рдХреЗ рд▓рд┐рдП рдиреБрд╕реНрдЦреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдФрд░ рдХреЗрд╡рд▓ рдбреЙрдХреНрдЯрд░ рдХреЗ рдирд┐рд░реНрджреЗрд╢рд╛рдиреБрд╕рд╛рд░ рд▓реЗрдирд╛ рдЪрд╛рд╣рд┐рдПред

**рд╕рд╛рдорд╛рдиреНрдп рдкреНрд░рдХрд╛рд░:**
тАв рдПрдореЛрдХреНрд╕рд┐рд╕рд┐рд▓рд┐рди
тАв рдПрдЬрд┐рдереНрд░реЛрдорд╛рдЗрд╕рд┐рди
тАв рд╕рд┐рдкреНрд░реЛрдлреНрд▓реЙрдХреНрд╕рд╛рд╕рд┐рди
тАв рдкреЗрдирд┐рд╕рд┐рд▓рд┐рди

**рдореБрдЦреНрдп рдмрд┐рдВрджреБ:**
тАв рдмреЗрд╣рддрд░ рдорд╣рд╕реВрд╕ рдХрд░рдиреЗ рдкрд░ рднреА рдкреВрд░рд╛ рдХреЛрд░реНрд╕ рдкреВрд░рд╛ рдХрд░реЗрдВ
тАв рдПрдВрдЯреАрдмрд╛рдпреЛрдЯрд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рди рдХрд░реЗрдВ
тАв рдмрдЪреЗ рд╣реБрдП рдПрдВрдЯреАрдмрд╛рдпреЛрдЯрд┐рдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ
тАв рдирд┐рдпрдорд┐рдд рдЕрдВрддрд░рд╛рд▓ рдкрд░ рд▓реЗрдВ
тАв рдХреБрдЫ рдХреЛ рднреЛрдЬрди рдХреЗ рд╕рд╛рде, рдХреБрдЫ рдХреЛ рдЦрд╛рд▓реА рдкреЗрдЯ рд▓реЗрдирд╛ рд╣реЛрддрд╛ рд╣реИ

**рджреБрд╖реНрдкреНрд░рднрд╛рд╡:**
тАв рдорддрд▓реА
тАв рджрд╕реНрдд
тАв рдПрд▓рд░реНрдЬрд┐рдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ
тАв рдпреАрд╕реНрдЯ рд╕рдВрдХреНрд░рдордг (рдорд╣рд┐рд▓рд╛рдПрдВ)

**тЪая╕П рдорд╣рддреНрд╡рдкреВрд░реНрдг:**
тАв рдПрдВрдЯреАрдмрд╛рдпреЛрдЯрд┐рдХ рдкреНрд░рддрд┐рд░реЛрдз рдПрдХ рдЧрдВрднреАрд░ рд╕рдорд╕реНрдпрд╛ рд╣реИ
тАв рдХреЗрд╡рд▓ рдбреЙрдХреНрдЯрд░ рдХреЗ рдиреБрд╕реНрдЦреЗ рдкрд░ рд▓реЗрдВ
тАв рдХрднреА рднреА рдПрдВрдЯреАрдмрд╛рдпреЛрдЯрд┐рдХреНрд╕ рд╕реЗ рд╕реНрд╡-рдЪрд┐рдХрд┐рддреНрд╕рд╛ рди рдХрд░реЗрдВ"""
                }
            }
        }
        
        # Default response for unknown queries
        self.default_response = {
            'en': "I'm not sure about that. Please consult a doctor or visit the nearest hospital for accurate advice.",
            'hi': "рдореБрдЭреЗ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдирд┐рд╢реНрдЪрд┐рдд рдирд╣реАрдВ рд╣реИред рд╕рдЯреАрдХ рд╕рд▓рд╛рд╣ рдХреЗ рд▓рд┐рдП рдХреГрдкрдпрд╛ рдбреЙрдХреНрдЯрд░ рд╕реЗ рд╕рд▓рд╛рд╣ рд▓реЗрдВ рдпрд╛ рдирд┐рдХрдЯрддрдо рдЕрд╕реНрдкрддрд╛рд▓ рдЬрд╛рдПрдВред"
        }
    
    def find_matching_topic(self, user_input):
        """Find the best matching health topic based on user input"""
        user_input_lower = user_input.lower()
        
        # Check each topic's keywords
        for topic, data in self.health_knowledge.items():
            for keyword in data['keywords']:
                if keyword.lower() in user_input_lower:
                    return topic
        
        return None
    
    def get_response(self, user_input, language='en'):
        """Get appropriate response for user input"""
        try:
            topic = self.find_matching_topic(user_input)
            
            if topic:
                return self.health_knowledge[topic]['response'].get(language, self.health_knowledge[topic]['response']['en'])
            else:
                return self.default_response.get(language, self.default_response['en'])
        except Exception as e:
            print(f"Error getting response: {str(e)}")
            return self.default_response.get(language, self.default_response['en'])
    
    def add_new_topic(self, topic_name, keywords, response_en, response_hi=None):
        """Add a new health topic to the knowledge base"""
        self.health_knowledge[topic_name] = {
            'keywords': keywords,
            'response': {
                'en': response_en,
                'hi': response_hi or response_en
            }
        }

def main():
    st.set_page_config(
        page_title="Health Chatbot - Arogya Mitra",
        page_icon="ЁЯдЦ",
        layout="wide"
    )
    
    # Initialize chatbot
    if 'chatbot' not in st.session_state:
        st.session_state.chatbot = HealthChatbot()
    
    if 'chat_history' not in st.session_state:
        st.session_state.chat_history = []
    
    if 'language' not in st.session_state:
        st.session_state.language = 'en'
    
    # Header
    st.title("ЁЯдЦ Health Chatbot")
    st.markdown("Ask me about common health topics like fever, cold, cough, diabetes, and medicines!")
    
    # Language selection
    col1, col2 = st.columns([1, 4])
    with col1:
        language = st.selectbox("Language", ["English", "рд╣рд┐рдВрджреА"], index=0)
        st.session_state.language = 'en' if language == "English" else 'hi'
    
    with col2:
        st.info("ЁЯТб **Tip:** I can help with fever, cold, cough, malaria, diabetes, TB, and common medicines like paracetamol, ibuprofen, and antibiotics.")
    
    # Chat interface
    st.subheader("ЁЯТм Chat with Health Bot")
    
    # Display chat history
    chat_container = st.container()
    with chat_container:
        for i, (timestamp, user_msg, bot_response) in enumerate(st.session_state.chat_history):
            with st.chat_message("user"):
                st.write(f"**You:** {user_msg}")
                st.caption(f"ЁЯХР {timestamp}")
            
            with st.chat_message("assistant"):
                st.markdown(bot_response)
    
    # Input form
    with st.form("chat_form", clear_on_submit=True):
        user_input = st.text_input(
            "Ask your health question:",
            placeholder="e.g., I have fever and headache, what should I do?",
            key="user_input"
        )
        
        col1, col2, col3 = st.columns([1, 1, 3])
        with col1:
            submit_button = st.form_submit_button("Send", use_container_width=True)
        with col2:
            clear_button = st.form_submit_button("Clear Chat", use_container_width=True)
        
        if clear_button:
            st.session_state.chat_history = []
            st.rerun()
        
        if submit_button and user_input.strip():
            # Get bot response
            bot_response = st.session_state.chatbot.get_response(user_input, st.session_state.language)
            
            # Add to chat history
            timestamp = datetime.now().strftime("%H:%M:%S")
            st.session_state.chat_history.append((timestamp, user_input, bot_response))
            
            st.rerun()
    
    # Quick action buttons
    st.subheader("ЁЯЪА Quick Health Topics")
    
    col1, col2, col3, col4 = st.columns(4)
    
    quick_topics = [
        ("Fever", "fever"),
        ("Cold", "cold"),
        ("Cough", "cough"),
        ("Diabetes", "diabetes")
    ]
    
    for i, (display_name, topic) in enumerate(quick_topics):
        with [col1, col2, col3, col4][i]:
            if st.button(f"ЁЯдТ {display_name}", use_container_width=True):
                # Simulate user input for quick topic
                user_input = f"I have {topic}"
                bot_response = st.session_state.chatbot.get_response(user_input, st.session_state.language)
                timestamp = datetime.now().strftime("%H:%M:%S")
                st.session_state.chat_history.append((timestamp, user_input, bot_response))
                st.rerun()
    
    # Footer
    st.markdown("---")
    st.markdown("""
    <div style='text-align: center; color: #666;'>
        <p><strong>тЪая╕П Disclaimer:</strong> This chatbot provides general health information only. 
        It is not a substitute for professional medical advice, diagnosis, or treatment. 
        Always consult a qualified healthcare provider for medical concerns.</p>
    </div>
    """, unsafe_allow_html=True)

if __name__ == "__main__":
    main()
